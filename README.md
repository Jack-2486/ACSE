# ACSE-for-Wheat-Disease-Identification

> 官方TensorFlow实现 | 论文处于投刊阶段，标题：《ACSE: An Efficient Deep Learning Network for Wheat Leaf Disease Identification》  
> 提出高效学习网络（ACSE）模型模型，实现小麦叶片常见病害与健康叶片的高精度分类，辅助农业病害快速诊断。


## 1. 研究背景与模型定位
小麦作为全球核心粮食作物，其叶片病害（如白粉病、条锈病、叶锈病）易导致光合效率骤降、产量损失达10%-30%，传统人工检测存在耗时久、主观性强、田间覆盖范围有限的问题。  

本文提出**高效学习网络（ACSE）**，通过创新的注意力机制融合与分层金字塔结构，解决小麦病害“多类别区分难、复杂背景干扰大”的问题。模型基于TensorFlow框架实现，包含4个核心卷积层与3个全连接层以及2种注意力机制，本研究通过技术优化，最终在自建小麦叶片病害数据集上实现 99.93% 的分类准确率，为小麦病害田间自动化诊断提供了高效且可靠的技术支撑方案。


## 2. ACSE 核心创新点
2.1. **轻量化部署**：
针对经典ALexNet网络层次进行重构，将传统卷积层11×11的大核卷积进行分化拆解，移除部分冗余结构，例如过多的Relu层等，在降低计算成本过高的同时实现了模型轻量化部署与感知性能的同步提升。

2.2. **多种注意力机制协同**：
设计一种新的模型组件整合策略，将拥有“通道-空间”双维度获取能力的CBAM（Convolutional block attention module）注意力机制以及能显著关注通道维度的SENet（Squeeze-and-excitation networks Convolutional block attention module）注意力机制通过卷积层逐级融合，实现跨层连接的多阶段特征结构。增强模型的判别性特征挖掘能力，在提高准确率的同时，以改进特征提取表达学习能力。

2.3. **跨样本统计量正则化**：
我们提出一种跨样本统计量正则化方法，通过约束各层输入的均值与方差至稳定区间，有效抑制深层网络中的数据分布波动，缓解因分布偏移所引起的梯度计算偏差，提升训练稳定性与泛化性能，让模型在少量的数据下同样有较好的表现。

2.4. **多样化数据来源**：  
为了确保实验的真实性与准确性，我们将提出的方法与其它较为经典的模型展开对比实验，在相同的环境下，采用自建的和公开的小麦数据集依据多项参数指标进行分析，多项结


## 3. 实验数据集
### 3.1 数据集概况
本研究基于**自建小麦叶片常见病害检测数据集（Wheat Leaf Disease Detection Dataset，WPLDD）**，数据集已随项目上传至仓库的 `WPLDD/` 文件夹，无需额外下载。  

| 数据集名称 | 包含类别                | 图像总数 | 图像分辨率 | 数据分布（训练:测试） |
|------------|-------------------------|----------|------------|-----------------------|
| WPLDD   | 枯萎病、白粉病、斑枯病、叶锈病、健康叶片 | 详见数据集说明文件 | 统一 resize 至 256×256 | 3:1（通过代码自动划分） |

### 3.2 数据集结构
仓库中 `WPLDD/` 文件夹组织如下，图像均采集于小麦主产区田间（涵盖不同生育期、光照与拍摄角度），可直接用于模型训练/测试：
```
xiao mai/
├── train/ # 训练集：包含各类小麦病害及健康植株的图像，用于模型参数学习
│ ├── 枯萎病 / # 小麦枯萎病叶片图像（病斑特征：叶片枯萎、变色，严重时大面积干枯，影响植株生理功能）
│ ├── 白粉病 / # 小麦白粉病叶片图像（病斑特征：叶片表面覆盖白色粉状霉层，阻碍气体交换与光合作用，导致叶片逐渐变黄、枯萎）
│ ├── 斑枯病 / # 小麦斑枯病叶片图像（病斑特征：初期为褐色小斑点，随病情发展扩大并连接成片，对叶片损害较大）
│ ├── 叶锈病 / # 小麦叶锈病叶片图像（病斑特征：产生锈色孢子堆，初期黄色或橙色，后期深褐色，使叶片失去光泽、功能衰退）
│ └── 健康植株 / # 健康小麦植株图像（特征：叶片鲜绿、形态舒展有光泽，整体生长旺盛，无病害或虫害迹象）
├── val/ # 验证集：用于模型训练过程中的参数调优与性能验证，确保模型不过拟合
│ ├── 枯萎病 / # 小麦枯萎病叶片图像（病斑特征：叶片枯萎、变色，严重时大面积干枯，影响植株生理功能）
│ ├── 白粉病 / # 小麦白粉病叶片图像（病斑特征：叶片表面覆盖白色粉状霉层，阻碍气体交换与光合作用，导致叶片逐渐变黄、枯萎）
│ ├── 斑枯病 / # 小麦斑枯病叶片图像（病斑特征：初期为褐色小斑点，随病情发展扩大并连接成片，对叶片损害较大）
│ ├── 叶锈病 / # 小麦叶锈病叶片图像（病斑特征：产生锈色孢子堆，初期黄色或橙色，后期深褐色，使叶片失去光泽、功能衰退）
│ └── 健康植株 / # 健康小麦植株图像（特征：叶片鲜绿、形态舒展有光泽，整体生长旺盛，无病害或虫害迹象）
└── test/ # 测试集：独立于训练 / 验证过程的图像集，用于客观评估模型最终泛化性能
├── 枯萎病 / # 小麦枯萎病叶片图像（病斑特征：叶片枯萎、变色，严重时大面积干枯，影响植株生理功能）
├── 白粉病 / # 小麦白粉病叶片图像（病斑特征：叶片表面覆盖白色粉状霉层，阻碍气体交换与光合作用，导致叶片逐渐变黄、枯萎）
├── 斑枯病 / # 小麦斑枯病叶片图像（病斑特征：初期为褐色小斑点，随病情发展扩大并连接成片，对叶片损害较大）
├── 叶锈病 / # 小麦叶锈病叶片图像（病斑特征：产生锈色孢子堆，初期黄色或橙色，后期深褐色，使叶片失去光泽、功能衰退）
└── 健康植株 / # 健康小麦植株图像（特征：叶片鲜绿、形态舒展有光泽，整体生长旺盛，无病害或虫害迹象）
```


## 4. 实验环境配置
### 4.1 依赖安装
推荐使用Anaconda创建虚拟环境，确保依赖版本匹配（避免兼容性问题，尤其适配PyTorch 2.7.1）：
```bash
# 1. 创建并激活虚拟环境
conda create -n hh-former-wheat python=3.10
conda activate hh-former-wheat

# 2. 安装PyTorch与TorchVision（需适配CUDA版本，示例为CUDA 12.1；CPU用户可替换为cpu版本）
pip3 install torch==2.7.1 torchvision==0.22.1 --index-url https://download.pytorch.org/whl/cu121

# 3. 安装其他依赖库（数据处理、可视化、模型工具等）
pip install numpy~=2.0.2 matplotlib~=3.9.4 opencv-python~=4.12.0.88
pip install pandas~=2.3.1 pillow~=11.2.1 torchviz~=0.0.3 xlwt~=1.3.0
pip install tqdm~=4.67.1 timm~=1.0.15
```

### 4.2 硬件要求
- **GPU**：推荐 NVIDIA GPU（显存≥8GB，如RTX 3060/4060，支持CUDA 11.8+），训练50轮耗时约2-3小时，显存占用峰值≤6GB；  
- **CPU**：支持推理测试（单张图像推理耗时约0.5-1秒），但训练耗时显著增加（约20-25小时），不推荐用于完整训练流程。


## 5. 实验结果
### 5.1 核心指标对比（WPLDD数据集）
ASCE 与主流深度学习模型在小麦叶片病害分类任务上的性能对比如下，模型在精度、计算效率上均表现更优，尤其对相似病害（条锈病/叶锈病）的区分能力显著提升：

| 模型                   | 分类准确率（Accuracy） | 计算量（FLOPs） | 参数量（M） |
|--------------------|------------------------|-----------------|------------ -|
| MobileNet-V3    | 89.04%                 | 2.1G              | 28.60          |
|ShuffleNetv2       | 90.53%                 | 4.4G              | 29.20          |
| EfficientNetV2    | 86.33%                 | 3.96G            | 27.94          |
| **ACSE本文）**  | **98.51%**            | **3.5G**        | **15.72**    |


## 6. 代码使用说明
### 6.1 模型训练
运行 `train.py` 脚本启动训练，支持通过参数调整训练配置，示例命令（适配WPLDD数据集）：
```bash
python train.py \
  --epochs 50 \
  --batch_size 32 \
  --lr 1e-4 \
  --weight_decay 1e-3 \
  --save_dir ./weights \
  --device cuda:0 
```

#### 关键参数说明：
| 参数名          | 含义                                  | 默认值       |
|-----------------|---------------------------------------|-------------|
| `--epochs`      | 训练轮数                              | 50         |
| `--batch_size`  | 批次大小（根据GPU显存调整，8/16/32）  | 32          |
| `--lr`          | 初始学习率                            | 1e-4        |
| `--save_dir`    | 训练权重保存目录                      | `./weights` |
| `--device`      | 训练设备（`cuda:0` 或 `cpu`）         | `cuda:0`    |

#### 训练输出：
- 训练过程中，模型会自动保存**验证集准确率最高**的权重至文件名为 `ACSE.pth`；  
- 训练日志（损失值、准确率）会实时打印在面板。

### 6.2 模型预测
使用训练好的权重进行单张小麦叶片图像预测，运行 `predict.py` 脚本，示例命令：
```bash
python predict.py \
  --image_dir ./examples/wheat_leaves/ \  # 输入图像所在目录（支持批量处理该目录下所有图片）
  --weight_path ./weights/best_hh_former.pth \  # 预训练权重文件路径
  --class_indices ./class_indices.json \  # 类别索引映射文件路径
  --device cuda:0 \  # 运行设备（cuda:0或cpu）
  --output_file ./prediction_results.txt  # 预测结果保存路径
```

#### 6.3预测输出示例：
```
（显示图像路径）：
真实：（显示真实图像标签）  预测：（显示预测图像内容）  准确率：XXXX
```


## 7. 项目文件结构
```
hh-former-for-wheat-leaf-disease/
├── WPLDD/                #小麦叶片病害数据分配情况（含白粉病、条锈病、斑枯病、叶锈病、健康叶片）
├──ACSE model/               # 模型定义文件夹，包括模型训练脚本、模型预测脚本等等
├── Build your own wheat dataset/              # 自己拍摄数据和对抗生成数据
└── README.md             # 项目说明文档（本文档）
```


## 8. 已知问题与注意事项
1. **数据集适配**：当前模型与权重仅针对 `WPLDD/` 中的“斑枯病、白粉病、叶枯病、叶锈病、健康叶片”五类，若新增病害类别，需补充对应数据集并重新训练（建议每类样本量≥500张，确保模型泛化性）；  
2. **图像分辨率**：输入图像会自动resize至256×256，若原始图像分辨率过低（<128×128），可能导致早期微小病斑特征丢失，建议输入图像分辨率≥256×256；  
3. **CUDA版本问题**：若安装PyTorch时出现CUDA不兼容，可替换为CPU版本（需将所有脚本的`--device`改为`cpu`），但训练效率会大幅下降；  


## 9. 引用与联系方式
### 9.1 引用方式
论文处于投刊阶段，正式发表后将更新BibTeX引用格式，当前可临时引用：
```bibtex
@article{hh_former_wheat_disease,
  title={
ACSE: An Efficient Deep Learning Network for Wheat Leaf Disease Identification },
  author={[作者姓名，待发表时补充]},
  journal={[期刊名称，待录用后补充]},
  year={2025},
  note={Manuscript submitted for publication}
}
```

### 9.2 联系方式
若遇到代码运行问题或学术交流需求，请联系：  
- 邮箱：dongjunqihuuc@yeah.net  
- GitHub Issue：直接在本仓库提交Issue，会在1-3个工作日内回复。
